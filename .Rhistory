DISCOID = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
levels(red_syst_data_a$red_syst)
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
flk_form=recode(comsafrica_data_cat_data_conda$red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
levels(red_syst_data_a$red_syst)
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
flk_form=recode(red_syst_data_a$red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
flk_form=recode(red_syst_data_a$red_syst,
Discoidal = "Discoid"))
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
flk_form=recode(red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
levels(red_syst_data_a$red_syst)
View(red_syst_data_a)
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst)
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
flk_form=recode(red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet"))
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
red_syst=recode(red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
levels(red_syst_data_a$red_syst)
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
red_syst=recode(red_syst,
Discoidal = "Discoid",
"" = "Indet",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
levels(red_syst_data_a$red_syst)
red_syst_data_a<-comsafrica_data_cat_data_conda %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
red_syst=recode(red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
levels(red_syst_data_a$red_syst)
# delete flake #'s with < 4 observations
red_syst_data_a<-red_syst_data_a[as.numeric(ave(red_syst_data_a$flake_id,
red_syst_data_a$flake_id,
FUN=length)) >= 6, ]
# reclass cat variables into numeric values for the krip stat
red_syst_data_a_krip<- red_syst_data_a %>%
mutate(red_sys_dummy=unclass(red_syst)) %>%
select(-red_syst) %>%
spread(analyst_id, red_sys_dummy) %>%
select(-flake_id) %>%
as.matrix()
set.seed(42)
fit.full_red_syst<-krippendorffs.alpha(red_syst_data_a_krip,
level = "nominal",
control = list(parallel = FALSE,bootit=100),
verbose = TRUE)
summary(fit.full_red_syst)
plot(fit.full_red_syst, xlim = c(0, 0.9),
xlab = "Bootstrap Estimates",
main = "Nominal Data",
density = FALSE)
# Compute kapa-allows us to see which categories are performing better
# requires actual categorical variables not reclasssed values
red_sys_data_a_fleiss<- red_syst_data_a %>%
mutate(red_syst=as.factor(red_syst)) %>%
spread(analyst_id, red_syst) %>%
select(-flake_id)
kappam.fleiss(red_sys_data_a_fleiss, detail = T)
View(red_syst_data_a)
View(red_sys_data_a_fleiss)
# Compute kapa-allows us to see which categories are performing better
# requires actual categorical variables not reclasssed values
red_sys_data_a_fleiss<- red_syst_data_a %>%
mutate(red_syst=as.factor(red_syst)) %>%
spread(analyst_id, red_syst) %>%
select(-flake_id)
View(red_sys_data_a_fleiss)
kappam.fleiss(red_sys_data_a_fleiss, detail = T)
red_syst_data_b<-comsafrica_data_cat_data_condb %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
red_syst=recode(red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
# delete flake #'s with < 4 observations
red_syst_data_b<-red_syst_data_b[as.numeric(ave(red_syst_data_b$flake_id,
red_syst_data_b$flake_id,
FUN=length)) >= 6, ]
# reclass cat variables into numeric values for the krip stat
red_syst_data_b_krip<- red_syst_data_b %>%
mutate(red_sys_dummy=unclass(red_syst)) %>%
select(-red_syst) %>%
spread(analyst_id, red_sys_dummy) %>%
select(-flake_id) %>%
as.matrix()
set.seed(42)
fit.full_red_syst<-krippendorffs.alpha(red_syst_data_b_krip,
level = "nominal",
control = list(parallel = FALSE,bootit=100),
verbose = TRUE)
summary(fit.full_red_syst)
levels(red_syst_data_b$red_syst)
red_syst_data_b<-comsafrica_data_cat_data_condb %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
red_syst=recode(red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
INDET = "Indet",
'indeterminate (broken)' = "Indet",
'Indeterminate (broken)' = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'levallois non nubian' = "Levallois",
'LEVALLOIS OR DISCOID' = "Indet",
na = "Indet",
none = "Indet",
'Platform (laminar?)' = "Platform",
'Platform / Laminar' = "Platform",
'possible Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Levallois (pref)' = "Levallois"
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
'Discoid?' = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
red_syst_data_b<-comsafrica_data_cat_data_condb %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
red_syst=recode(red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
INDET = "Indet",
'indeterminate (broken)' = "Indet",
'Indeterminate (broken)' = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'levallois non nubian' = "Levallois",
'LEVALLOIS OR DISCOID' = "Indet",
na = "Indet",
none = "Indet",
'Platform (laminar?)' = "Platform",
'Platform / Laminar' = "Platform",
'possible Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Levallois (pref)' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
'Discoid?' = "Discoid",
FLAKE = "Flake")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
levels(red_syst_data_b$red_syst)
red_syst_data_b<-comsafrica_data_cat_data_condb %>%
select(flake_id,analyst_id,red_syst) %>%
mutate(red_syst=as.factor(red_syst),
red_syst=recode(red_syst,
Discoidal = "Discoid",
idnet = "Indet",
inde = "Indet",
Indeterminate = "Indet",
other = "Indet",
Ind = "Indet",
indet = "Indet",
indeterminate = "Indet",
INDET = "Indet",
'indeterminate (broken)' = "Indet",
'Indeterminate (broken)' = "Indet",
laminar = "Laminar",
'Lev or Disc' = "Indet",
'Levallois indet' = "Levallois",
'Levallois non-Nubian' = "Levallois",
'levallois non nubian' = "Levallois",
'LEVALLOIS OR DISCOID' = "Indet",
na = "Indet",
none = "Indet",
'Platform (laminar?)' = "Platform",
'Platform / Laminar' = "Platform",
'possible Levallois non-Nubian' = "Levallois",
'LEVALLOIS/LEVALLOIS-RELATED' = "Levallois",
'Levallois (pref)' = "Levallois",
'Other (informal)' = "Indet",
'potential levallois' = "Levallois",
levallois = "Levallois",
LEVALLOIS = "Levallois",
'Levallois non Nubian' = "Levallois",
'Levallois?' = "Levallois",
'potential Lev' = "Levallois",
'potential Levallois' = "Levallois",
CENTRIPETAL = "Discoid",
discoid = "Discoid",
DISCOID = "Discoid",
'Discoid?' = "Discoid",
FLAKE = "Flake",
multidirectional = "Platform",
'NON-LEVALLOIS; ORTHOGONAL VOLUME EXPLOITATION' = "Platform")) %>%
na_if("") %>% #delete coding episodes with no data
na.omit
levels(red_syst_data_b$red_syst)
# delete flake #'s with < 4 observations
red_syst_data_b<-red_syst_data_b[as.numeric(ave(red_syst_data_b$flake_id,
red_syst_data_b$flake_id,
FUN=length)) >= 6, ]
# reclass cat variables into numeric values for the krip stat
red_syst_data_b_krip<- red_syst_data_b %>%
mutate(red_sys_dummy=unclass(red_syst)) %>%
select(-red_syst) %>%
spread(analyst_id, red_sys_dummy) %>%
select(-flake_id) %>%
as.matrix()
set.seed(42)
fit.full_red_syst<-krippendorffs.alpha(red_syst_data_b_krip,
level = "nominal",
control = list(parallel = FALSE,bootit=100),
verbose = TRUE)
summary(fit.full_red_syst)
View(red_syst_data_b)
# Compute kapa-allows us to see which categories are performing better
# requires actual categorical variables not reclasssed values
red_sys_data_b_fleiss<- red_syst_data_b %>%
mutate(red_syst=as.factor(red_syst)) %>%
spread(analyst_id, red_syst) %>%
select(-flake_id)
kappam.fleiss(red_sys_data_b_fleiss, detail = T)
View(red_sys_data_b_fleiss)
# cortex-NOT SURE WHAT TO DO WITH CORTEX-STRANGE DISTRIBUTION?
hist(log(comsafrica_data_complete$dorsal_cortex))
# cortex-NOT SURE WHAT TO DO WITH CORTEX-STRANGE DISTRIBUTION?
hist((comsafrica_data_complete$dorsal_cortex))
# cortex-NOT SURE WHAT TO DO WITH CORTEX-STRANGE DISTRIBUTION?
hist(log(comsafrica_data_complete$dorsal_cortex))
set.seed(50)
comsafrica_cortex_boot<-rpt(dorsal_cortex ~ (1 | flake_id),
grname = "flake_id",
data = comsafrica_data_complete,
datatype = "Gaussian",
nboot = 1000, npermut = 100)
library(dplyr)
library(rptR)
library(krippendorffsalpha)
library(tidyverse)
library(irr)
comsafrica_data<-read.csv("comsafrica_complete_adjusted.csv") %>%
subset(!flake_id == "NONR3495") #filter out this non numbered flake
# change column names to lower case
colnames(comsafrica_data) <- tolower(colnames(comsafrica_data))
attach(comsafrica_data)
cols <- c("assemblage_code", "analyst_id", "flake_id", "completeness", "damage",
"dorsal_cortex", "Dorsal_Cortex_Location", "dorsal_cortex_location_other",
"platform_cortex", "dorsal_scar_count", "directionality", "Proximal_Scars",
"Left_Scars", "Distal_Scars", "Right_Scars", "PLATFMORPH", "PLATFLIPP", "BULB",
"SHATTBULB", "INITIATION", "VENTR_PLANE_FORM", "SECTION", "LATEDGETYPE", "FLAKETERM",
"DISTPLANFORM", "KOMBEWA", "FLK_TYPE", "RED_SYST", "FLK_FORM")
data1[cols] <- lapply(comsafrica_data[cols], factor) #not clear where data1 is here?
comsafrica_data_complete<-comsafrica_data %>%
select(c(assemblage_code,analyst_id,flake_id,proximal_scars,left_scars,distal_scars,right_scars,
dorsal_cortex,mass,maximumdimension,maximumwidth,maximumthickness,techlength,techmaxwidth,techmaxthickness,
techwidthprox,techwidthmes,techwidthdist,techthickprox,techthickmes,techthickdist,
platfwidth,platfthickimpact,platfthickmid,platfthickmax,edgeplatf))
# cortex-NOT SURE WHAT TO DO WITH CORTEX-STRANGE DISTRIBUTION?
hist(log(comsafrica_data_complete$dorsal_cortex))
set.seed(50)
comsafrica_cortex_boot<-rpt(dorsal_cortex ~ (1 | flake_id),
grname = "flake_id",
data = comsafrica_data_complete,
datatype = "Gaussian",
nboot = 1000, npermut = 100)
summary(comsafrica_cortex_boot)
View(comsafrica_data_complete)
comsafrica_cortex_boot<-rpt(dorsal_cortex ~ (1 | flake_id) + (1 | assemblage_code),
grname = "flake_id",
data = comsafrica_data_complete,
datatype = "Gaussian",
nboot = 1000, npermut = 100)
summary(comsafrica_cortex_boot)
summary(comsafrica_cortex_boot$mod)
plot(comsafrica_cortex_boot, type = "boot", cex.main = 0.8,main="maximum dimension")
plot(comsafrica_cortex_boot, type = "permut", cex.main = 1)
